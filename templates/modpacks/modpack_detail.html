{% extends 'base.html' %}
{% load static %}

{% block title %}{{ modpack.name }} - Asylum Dev{% endblock %}

{% block content %}
<div style="max-width: 1400px; margin: 0 auto;">
    <div style="margin-bottom: 2rem;">
        <a href="{% url 'modpacks:modpack_list' %}" style="color: #4a90e2; text-decoration: none; display: inline-flex; align-items: center; margin-bottom: 1rem;">
            <i class="fas fa-arrow-left" style="margin-right: 0.5rem;"></i> Back to Modpacks
        </a>
    </div>

    <div style="background: rgba(255, 255, 255, 0.1); backdrop-filter: blur(10px); border-radius: 15px; overflow: hidden; margin-bottom: 2rem;">
        <div style="position: relative;">
            {% if modpack.image_url %}
                <img src="{{ modpack.image_url }}" alt="{{ modpack.name }}" style="width: 100%; height: 300px; object-fit: cover;">
            {% else %}
                <div style="width: 100%; height: 300px; background: linear-gradient(45deg, #4a90e2, #357abd); display: flex; align-items: center; justify-content: center;">
                    <i class="fas fa-cube" style="font-size: 4rem; color: rgba(255, 255, 255, 0.7);"></i>
                </div>
            {% endif %}
            <div style="position: absolute; top: 15px; left: 15px; background: rgba(0, 0, 0, 0.7); color: #ffffff; padding: 0.5rem 1rem; border-radius: 5px; font-size: 0.9rem; font-weight: bold;">
                <img src="{% static 'images/logo.png' %}" alt="AsylumDev" style="height: 20px; width: auto;">
            </div>
        </div>
        
        <div style="padding: 2rem;">
            <h1 style="font-size: 2.5rem; margin-bottom: 1rem; color: #ffffff;">{{ modpack.name }}</h1>
            
            <!-- 2-Panel Layout -->
            <div style="display: flex; gap: 2rem; margin-bottom: 2rem;">
                <!-- Left Panel - Description (70%) -->
                <div style="flex: 0 0 70%;">
                    {% if modpack.description %}
                    <div style="background: rgba(255, 255, 255, 0.05); padding: 1.5rem; border-radius: 10px;">
                        <h3 style="color: #4a90e2; margin-bottom: 1rem; font-size: 1.2rem;">Description</h3>
                        <div class="modpack-description" style="color: rgba(255, 255, 255, 0.9); line-height: 1.6; font-size: 1rem; word-wrap: break-word; overflow-wrap: break-word; hyphens: auto;">
                            {{ modpack.description|safe }}
                        </div>
                        <style>
                            .modpack-description {
                                word-wrap: break-word;
                                overflow-wrap: break-word;
                                hyphens: auto;
                                max-width: 100%;
                            }
                            .modpack-description img {
                                max-width: 100%;
                                height: auto;
                                border-radius: 8px;
                                margin: 1rem 0;
                                box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
                            }
                            .modpack-description a {
                                color: #4a90e2;
                                text-decoration: none;
                                word-break: break-word;
                            }
                            .modpack-description a:hover {
                                text-decoration: underline;
                            }
                            .modpack-description h1, .modpack-description h2, .modpack-description h3 {
                                color: #4a90e2;
                                margin-top: 1.5rem;
                                margin-bottom: 0.5rem;
                                word-wrap: break-word;
                            }
                            .modpack-description ul, .modpack-description ol {
                                margin-left: 1.5rem;
                                margin-bottom: 1rem;
                            }
                            .modpack-description li {
                                margin-bottom: 0.25rem;
                                word-wrap: break-word;
                            }
                            .modpack-description p {
                                word-wrap: break-word;
                                overflow-wrap: break-word;
                                margin-bottom: 1rem;
                            }
                        </style>
                    </div>
                    {% else %}
                    <div style="background: rgba(255, 255, 255, 0.05); padding: 1.5rem; border-radius: 10px;">
                        <h3 style="color: #4a90e2; margin-bottom: 1rem; font-size: 1.2rem;">Description</h3>
                        <div style="color: rgba(255, 255, 255, 0.5); font-style: italic;">
                            No description available for this modpack.
                        </div>
                    </div>
                    {% endif %}
                </div>
                
                <!-- Right Panel - Stats & Files (30%) -->
                <div style="flex: 0 0 30%;">
                    <div style="background: rgba(255, 255, 255, 0.05); padding: 1.5rem; border-radius: 10px; margin-bottom: 1.5rem;">
                        <h3 style="color: #4a90e2; margin-bottom: 1rem; font-size: 1.2rem;">Statistics</h3>
                        
                        <div style="display: flex; flex-direction: column; gap: 1rem;">
                            <div style="background: rgba(255, 255, 255, 0.1); padding: 1rem; border-radius: 8px;">
                                <div style="color: rgba(255, 255, 255, 0.7); font-size: 0.9rem; margin-bottom: 0.5rem;">Last Updated</div>
                                <div style="color: #ffffff; font-weight: bold;">{{ modpack.last_updated|date:"M d, Y" }}</div>
                            </div>
                            
                            <div style="background: rgba(255, 255, 255, 0.1); padding: 1rem; border-radius: 8px;">
                                <div style="color: rgba(255, 255, 255, 0.7); font-size: 0.9rem; margin-bottom: 0.5rem;">Minecraft Version</div>
                                <div style="color: #ffffff; font-weight: bold;">{{ modpack.minecraft_version|default:"Unknown" }}</div>
                            </div>
                            
                            <div style="background: rgba(255, 255, 255, 0.1); padding: 1rem; border-radius: 8px;">
                                <div style="color: rgba(255, 255, 255, 0.7); font-size: 0.9rem; margin-bottom: 0.5rem;">Modloader</div>
                                <div style="color: #ffffff; font-weight: bold;">{{ modpack.modloader|default:"Unknown" }}</div>
                            </div>
                            
                            {% if modpack.downloads > 0 %}
                            <div style="background: rgba(255, 255, 255, 0.1); padding: 1rem; border-radius: 8px;">
                                <div style="color: rgba(255, 255, 255, 0.7); font-size: 0.9rem; margin-bottom: 0.5rem;">Downloads</div>
                                <div style="color: #4a90e2; font-weight: bold;">
                                    <i class="fas fa-download" style="margin-right: 0.5rem;"></i>
                                    {{ modpack.downloads|floatformat:0 }}
                                </div>
                            </div>
                            {% endif %}
                            
                            {% if modpack.followers > 0 %}
                            <div style="background: rgba(255, 255, 255, 0.1); padding: 1rem; border-radius: 8px;">
                                <div style="color: rgba(255, 255, 255, 0.7); font-size: 0.9rem; margin-bottom: 0.5rem;">Followers</div>
                                <div style="color: #4a90e2; font-weight: bold;">
                                    <i class="fas fa-heart" style="margin-right: 0.5rem;"></i>
                                    {{ modpack.followers|floatformat:0 }}
                                </div>
                            </div>
                            {% endif %}
                        </div>
                    </div>
                    
                    <!-- Latest Files Section -->
                    {% if latest_files %}
                    <div style="background: rgba(255, 255, 255, 0.05); padding: 1.5rem; border-radius: 10px; margin-bottom: 1.5rem;">
                        <h3 style="color: #4a90e2; margin-bottom: 1rem; font-size: 1.2rem;">Latest Files</h3>
                        
                        <div style="display: flex; flex-direction: column; gap: 0.75rem;">
                            {% for file in latest_files %}
                            <div style="background: rgba(255, 255, 255, 0.1); padding: 1rem; border-radius: 8px;">
                                <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 0.5rem; gap: 0.5rem;">
                                    <div style="font-weight: bold; color: #ffffff; font-size: 0.9rem; flex: 1; min-width: 0;">{{ file.display_name }}</div>
                                    {% if file.release_type == 1 %}
                                        <span style="background: rgba(78, 205, 196, 0.2); color: #4ecdc4; padding: 0.2rem 0.4rem; border-radius: 4px; font-size: 0.7rem; white-space: nowrap; flex-shrink: 0;">
                                            Release
                                        </span>
                                    {% elif file.release_type == 2 %}
                                        <span style="background: rgba(254, 202, 87, 0.2); color: #feca57; padding: 0.2rem 0.4rem; border-radius: 4px; font-size: 0.7rem; white-space: nowrap; flex-shrink: 0;">
                                            Beta
                                        </span>
                                    {% elif file.release_type == 3 %}
                                        <span style="background: rgba(255, 107, 107, 0.2); color: #ff6b6b; padding: 0.2rem 0.4rem; border-radius: 4px; font-size: 0.7rem; white-space: nowrap; flex-shrink: 0;">
                                            Alpha
                                        </span>
                                    {% endif %}
                                </div>
                                
                                <div style="color: rgba(255, 255, 255, 0.6); font-size: 0.8rem; margin-bottom: 0.5rem; word-break: break-word;">
                                    {% if file.file_name|slice:"-4:" == ".zip" %}
                                        {{ file.file_name|slice:":-4" }}
                                    {% else %}
                                        {{ file.file_name }}
                                    {% endif %}
                                </div>
                                
                                <div style="display: flex; justify-content: space-between; align-items: center; font-size: 0.8rem; gap: 0.5rem;">
                                    <div style="color: rgba(255, 255, 255, 0.7); flex: 1;">
                                        {% if file.file_date %}
                                            {{ file.file_date|slice:":10"|date:"M d, Y" }}
                                        {% else %}
                                            Unknown
                                        {% endif %}
                                    </div>
                                    <div style="color: rgba(255, 255, 255, 0.7); flex-shrink: 0;">
                                        {% if file.file_length %}
                                            {% widthratio file.file_length 1048576 1 %} MB
                                        {% else %}
                                            Unknown
                                        {% endif %}
                                    </div>
                                </div>
                                
                                {% if file.download_url %}
                                <div style="margin-top: 0.5rem;">
                                    <a href="{{ file.download_url }}" target="_blank" style="background: rgba(74, 144, 226, 0.2); color: #4a90e2; padding: 0.4rem 0.8rem; border-radius: 4px; text-decoration: none; font-size: 0.8rem; display: inline-block; white-space: nowrap;">
                                        <i class="fas fa-download" style="margin-right: 0.25rem;"></i>
                                        Download
                                    </a>
                                </div>
                                {% endif %}
                            </div>
                            {% endfor %}
                        </div>
                        
                        <div style="margin-top: 1rem; text-align: center;">
                            <a href="{% url 'modpacks:modpack_files' modpack.slug %}" style="color: #4a90e2; text-decoration: none; font-size: 0.9rem;">
                                View All Files <i class="fas fa-arrow-right" style="margin-left: 0.25rem;"></i>
                            </a>
                        </div>
                    </div>
                    {% endif %}
                    
                    <div style="background: rgba(255, 255, 255, 0.05); padding: 1.5rem; border-radius: 10px;">
                        <h3 style="color: #4a90e2; margin-bottom: 1rem; font-size: 1.2rem;">Quick Actions</h3>
                        
                        <div style="display: flex; flex-direction: column; gap: 1rem;">
                            {% if modpack.curseforge_url %}
                            <a href="{{ modpack.curseforge_url }}" target="_blank" class="filter-btn" style="text-decoration: none; display: inline-flex; align-items: center; justify-content: center; padding: 0.75rem 1rem; background: rgba(74, 144, 226, 0.2); border: 1px solid rgba(74, 144, 226, 0.3); border-radius: 8px; color: #4a90e2; transition: all 0.3s ease;">
                                <i class="fas fa-external-link-alt" style="margin-right: 0.5rem;"></i>
                                View on CurseForge
                            </a>
                            {% endif %}
                            
                            <a href="{% url 'modpacks:modpack_dependencies' modpack.slug %}" class="filter-btn" style="text-decoration: none; display: inline-flex; align-items: center; justify-content: center; padding: 0.75rem 1rem; background: rgba(255, 255, 255, 0.1); border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 8px; color: #ffffff; transition: all 0.3s ease;">
                                <i class="fas fa-list" style="margin-right: 0.5rem;"></i>
                                View Modlist
                            </a>
                        </div>
                        

                    </div>
                </div>
            </div>
        </div>
    </div>

    {% if related_modpacks %}
    <div style="margin-top: 3rem;">
        <h2 style="font-size: 2rem; margin-bottom: 2rem; color: #4a90e2;">Related Modpacks</h2>
        <div class="modpack-grid">
            {% for related_modpack in related_modpacks %}
                <div class="modpack-card">
                    <div style="position: relative;">
                        {% if related_modpack.image_url %}
                            <img src="{{ related_modpack.image_url }}" alt="{{ related_modpack.name }}" class="modpack-image">
                        {% else %}
                            <div class="modpack-image" style="background: linear-gradient(45deg, #4a90e2, #357abd); display: flex; align-items: center; justify-content: center;">
                                <i class="fas fa-cube" style="font-size: 3rem; color: rgba(255, 255, 255, 0.7);"></i>
                            </div>
                        {% endif %}
                        <div class="modpack-image-overlay">Logo</div>
                    </div>
                    <div class="modpack-info">
                        <h3 class="modpack-title">{{ related_modpack.name }}</h3>
                        <div class="modpack-details">
                            <div>Minecraft {{ related_modpack.minecraft_version|default:"Unknown" }}</div>
                            <div>Modloader {{ related_modpack.modloader|default:"Unknown" }}</div>
                            {% if related_modpack.downloads > 0 %}
                                <div style="margin-top: 0.5rem; color: #4a90e2;">
                                    <i class="fas fa-download"></i> {{ related_modpack.downloads|floatformat:0 }} downloads
                                </div>
                            {% endif %}
                        </div>
                    </div>
                </div>
            {% endfor %}
        </div>
    </div>
    {% endif %}
</div>
{% endblock %} 